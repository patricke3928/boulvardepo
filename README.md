# –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–∞—Ä–æ–ª—ñ–≤ —Ç–∞ –º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞—Ä–æ–ª—ñ–≤ –∑ RSA-2048 —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è–º

## üìã –ó–º—ñ—Å—Ç
1. [–ü—Ä–æ –ø—Ä–æ–µ–∫—Ç](#–ø—Ä–æ-–ø—Ä–æ–µ–∫—Ç)
2. [–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è](#–≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è)
3. [–ó–∞–ø—É—Å–∫](#–∑–∞–ø—É—Å–∫)
4. [API](#api)
5. [–ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞](#–∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞)
6. [RSA-2048 –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—è](#rsa-2048-–∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—è)
7. [–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è](#–≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è)
8. [–ë–µ–∑–ø–µ–∫–∞](#–±–µ–∑–ø–µ–∫–∞)

---

## –ü—Ä–æ –ø—Ä–æ–µ–∫—Ç

Django-–¥–æ–¥–∞—Ç–æ–∫ –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø–∞—Ä–æ–ª—è–º–∏ –∑ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω–∏–º —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è–º –Ω–∞ –±–∞–∑—ñ **RSA-2048**. –ü—Ä–æ–µ–∫—Ç –ø—ñ–¥—Ö–æ–¥–∏—Ç—å —è–∫ –ø—Ä–∞–∫—Ç–∏—á–Ω–∞ —á–∞—Å—Ç–∏–Ω–∞ –∫—É—Ä—Å–æ–≤–æ—ó —Ä–æ–±–æ—Ç–∏ –Ω–∞ —Ç–µ–º—É "–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–∞—Ä–æ–ª—ñ–≤ —Ç–∞ –º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞—Ä–æ–ª—ñ–≤ –∑ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è–º –∞–ª–≥–æ—Ä–∏—Ç–º–∞–º–∏ RSA".

### –û—Å–Ω–æ–≤–Ω—ñ –º–æ–∂–ª–∏–≤–æ—Å—Ç—ñ:
- üîê **RSA-2048 —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è** - –∞—Å–∏–º–µ—Ç—Ä–∏—á–Ω–µ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ—ó –±–µ–∑–ø–µ–∫–∏
- üîë **–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –ø–∞—Ä–æ–ª—ñ–≤** - –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω–æ –±–µ–∑–ø–µ—á–Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü—ñ—è –∑ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è–º–∏
- üíæ **–ú–µ–Ω–µ–¥–∂–µ—Ä –ø–∞—Ä–æ–ª—ñ–≤** - –±–µ–∑–ø–µ—á–Ω–µ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—ñ–≤ —É –ë–î
- üîì **–ë–µ–∑–ø–µ—á–Ω–µ —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è** - —Ç—ñ–ª—å–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á –º–∞—î –¥–æ—Å—Ç—É–ø
- üì± **–í–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å** - –∑—Ä—É—á–Ω–∏–π —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è
- üåê **REST API** - –¥–ª—è –ø—Ä–æ–≥—Ä–∞–º–Ω–æ—ó —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó

---

## –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è

### 1. –ö–ª–æ–Ω—É–≤–∞–Ω–Ω—è/—Ä–æ–∑–ø–∞–∫—É–≤–∞–Ω–Ω—è –ø—Ä–æ–µ–∫—Ç—É
```bash
cd /path/to/project
```

### 2. –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π
```bash
pip install -r requirements.txt
```

**–ö–ª—é—á–æ–≤—ñ –∑–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ:**
- Django 5.2.7 - –≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫
- cryptography 46.0.3 - –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω—ñ —Ñ—É–Ω–∫—Ü—ñ—ó
- Pillow 12.0.0 - –æ–±—Ä–æ–±–∫–∞ –∑–æ–±—Ä–∞–∂–µ–Ω—å

### 3. –ó–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è –º—ñ–≥—Ä–∞—Ü—ñ–π
```bash
python manage.py migrate
```

### 4. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
```bash
python manage.py createsuperuser
```

---

## –ó–∞–ø—É—Å–∫

### –†–æ–∑—Ä–æ–±–Ω–∏–π —Å–µ—Ä–≤–µ—Ä
```bash
python manage.py runserver
```

–î–æ–¥–∞—Ç–æ–∫ –±—É–¥–µ –¥–æ—Å—Ç—É–ø–Ω–∏–π –∑–∞ –∞–¥—Ä–µ—Å–æ—é: **http://localhost:8000**

### –ó—É–ø–∏–Ω–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
```
–ù–∞—Ç–∏—Å–Ω—ñ—Ç—å Ctrl+C —É —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ
```

---

## API

### –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –ø–∞—Ä–æ–ª—è

**Endpoint:** `GET /users/generate-password/`

**–ü–∞—Ä–∞–º–µ—Ç—Ä–∏:**
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –¢–∏–ø | –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º | –û–ø–∏—Å |
|----------|-----|------------------|------|
| `length` | int | 32 | –î–æ–≤–∂–∏–Ω–∞ –ø–∞—Ä–æ–ª—è (8-128) |
| `letters` | bool | true | –í–∫–ª—é—á–∏—Ç–∏ –±—É–∫–≤–∏ (a-z, A-Z) |
| `numbers` | bool | true | –í–∫–ª—é—á–∏—Ç–∏ —Ü–∏—Ñ—Ä–∏ (0-9) |
| `symbols` | bool | true | –í–∫–ª—é—á–∏—Ç–∏ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—ñ —Å–∏–º–≤–æ–ª–∏ |

**–ü—Ä–∏–∫–ª–∞–¥–∏ –∑–∞–ø–∏—Ç—ñ–≤:**

```bash
# –ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º (32 —Å–∏–º–≤–æ–ª–∏)
curl http://localhost:8000/users/generate-password/

# 24 —Å–∏–º–≤–æ–ª–∏ –±–µ–∑ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–∏—Ö —Å–∏–º–≤–æ–ª—ñ–≤
curl "http://localhost:8000/users/generate-password/?length=24&symbols=false"

# 48 —Å–∏–º–≤–æ–ª—ñ–≤, —Ç—ñ–ª—å–∫–∏ –±—É–∫–≤–∏ —Ç–∞ —Ü–∏—Ñ—Ä–∏
curl "http://localhost:8000/users/generate-password/?length=48&symbols=false"

# 16 —Å–∏–º–≤–æ–ª—ñ–≤ (–º—ñ–Ω—ñ–º—É–º)
curl "http://localhost:8000/users/generate-password/?length=16"
```

**–í—ñ–¥–ø–æ–≤—ñ–¥—å:**
```json
{
  "password": "aB3$cD9#eF7@gH2%iJ5&kL8*mN1(oP4)qR6!sT0-uV2=wX4"
}
```

### –£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø–∞—Ä–æ–ª—è–º–∏

–ü–∞—Ä–æ–ª—ñ –∑–±–µ—Ä—ñ–≥–∞—é—Ç—å—Å—è —É **–¥–≤–æ—Ö –º–æ–¥–µ–ª—è—Ö**:

#### 1. PasswordEntry (–ú–µ–Ω–µ–¥–∂–µ—Ä –ø–∞—Ä–æ–ª—ñ–≤)
–î–ª—è –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—ñ–≤ –≤—ñ–¥ —Ä—ñ–∑–Ω–∏—Ö —Å–µ—Ä–≤—ñ—Å—ñ–≤ (GitHub, Gmail —Ç–æ—â–æ)

- –ß–µ—Ä–µ–∑ –≤–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å: http://localhost:8000/users/vault/
- –ü–æ–ª—è: `title`, `login`, `password`, `url`, `notes`

#### 2. VaultEntry (–°–µ–π—Ñ)
–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∞ –º–æ–¥–µ–ª—å –¥–ª—è –∑–±–µ—Ä—ñ–≥–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—ñ–≤

---

## –ê—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç—É
```
project/
‚îú‚îÄ‚îÄ users/
‚îÇ   ‚îú‚îÄ‚îÄ crypto.py              # ‚ú® RSA —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è (–ö–õ–Æ–ß–û–í–ò–ô –§–ê–ô–õ)
‚îÇ   ‚îú‚îÄ‚îÄ models.py              # PasswordEntry, VaultEntry
‚îÇ   ‚îú‚îÄ‚îÄ views.py               # REST API + –≤–µ–±-–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–Ω—è
‚îÇ   ‚îú‚îÄ‚îÄ forms.py               # Django —Ñ–æ—Ä–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ urls.py                # URL –º–∞—Ä—à—Ä—É—Ç–∏
‚îÇ   ‚îî‚îÄ‚îÄ migrations/            # –ú—ñ–≥—Ä–∞—Ü—ñ—ó –ë–î
‚îú‚îÄ‚îÄ blog/                       # –î–æ–¥–∞—Ç–æ–∫ –±–ª–æ–≥—É
‚îú‚îÄ‚îÄ tours/                      # –î–æ–¥–∞—Ç–æ–∫ —Ç—É—Ä—ñ–≤
‚îú‚îÄ‚îÄ travelbook/
‚îÇ   ‚îú‚îÄ‚îÄ settings.py            # –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è Django
‚îÇ   ‚îú‚îÄ‚îÄ urls.py                # –ì–æ–ª–æ–≤–Ω—ñ URL –º–∞—Ä—à—Ä—É—Ç–∏
‚îÇ   ‚îî‚îÄ‚îÄ wsgi.py
‚îú‚îÄ‚îÄ templates/                 # HTML —à–∞–±–ª–æ–Ω–∏
‚îú‚îÄ‚îÄ static/                    # CSS, JS, –∑–æ–±—Ä–∞–∂–µ–Ω–Ω—è
‚îú‚îÄ‚îÄ manage.py                  # Django CLI
‚îú‚îÄ‚îÄ requirements.txt           # –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ Python
‚îú‚îÄ‚îÄ db.sqlite3                 # –†–æ–∑–≤–∏–≤–∞–ª—å–Ω–∞ –±–∞–∑–∞ –¥–∞–Ω–∏—Ö
‚îî‚îÄ‚îÄ README.md                  # –¶–µ–π —Ñ–∞–π–ª
```

### –ú–æ–¥–µ–ª—å –¥–∞–Ω–∏—Ö

#### PasswordEntry
```python
class PasswordEntry:
    owner              # User (–≤–ª–∞—Å–Ω–∏–∫)
    title              # str - –Ω–∞–∑–≤–∞ —Å–µ—Ä–≤—ñ—Å—É (GitHub, Gmail, etc)
    login              # str - –ª–æ–≥—ñ–Ω/email
    password_encrypted # bytes - –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π –ø–∞—Ä–æ–ª—å (RSA)
    url                # str - URL —Å–µ—Ä–≤—ñ—Å—É
    notes              # str - –ø—Ä–∏–º—ñ—Ç–∫–∏
    created_at         # datetime - –¥–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è
    updated_at         # datetime - –¥–∞—Ç–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
```

#### VaultEntry
```python
class VaultEntry:
    owner              # User (–≤–ª–∞—Å–Ω–∏–∫)
    title              # str - –Ω–∞–∑–≤–∞ –∑–∞–ø–∏—Å—É
    login              # str - –ª–æ–≥—ñ–Ω
    password_encrypted # bytes - –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π –ø–∞—Ä–æ–ª—å (RSA)
    url                # str - URL
    notes              # str - –ø—Ä–∏–º—ñ—Ç–∫–∏
    created_at         # datetime - –¥–∞—Ç–∞ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è
    updated_at         # datetime - –¥–∞—Ç–∞ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è
```

### –°–∏—Å—Ç–µ–º–∞ –¥–æ–∑–≤–æ–ª—ñ–≤

**–Ü—î—Ä–∞—Ä—Ö—ñ—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ –ú–µ–≥–∞-–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä (Mega)   ‚îÇ  <- ptrkxlord (–∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º)
‚îÇ ‚úì –í–∏–¥–∞—î –ø—Ä–∞–≤–∞ –∞–¥–º—ñ–Ω—É        ‚îÇ
‚îÇ ‚úì –ö–µ—Ä—É—î –≤—Å—ñ–º–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º–∏ ‚îÇ
‚îÇ ‚úì –ü–æ–≤–Ω–∏–π –¥–æ—Å—Ç—É–ø –¥–æ —Å–∏—Å—Ç–µ–º–∏  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ –ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä (is_staff)   ‚îÇ
    ‚îÇ ‚úì –ö–µ—Ä—É—î –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º          ‚îÇ
    ‚îÇ ‚úó –ù–µ –≤–∏–¥–∞—î –ø—Ä–∞–≤–∞ –∞–¥–º—ñ–Ω—É    ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
           ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ –ó–≤–∏—á–∞–π–Ω–∏–π –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á    ‚îÇ
    ‚îÇ ‚úì –ú–æ–∂–µ –∫–µ—Ä—É–≤–∞—Ç–∏ —Å–≤–æ—ó–º   ‚îÇ
    ‚îÇ   –ø—Ä–æ—Ñ—ñ–ª–µ–º —Ç–∞ –ø–∞—Ä–æ–ª—è–º–∏  ‚îÇ
    ‚îÇ ‚úó –ù–µ–º–∞—î –∞–¥–º—ñ–Ω-–ø—Ä–∞–≤–∞     ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## RSA-2048 –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—è

### –©–æ —Ç–∞–∫–µ RSA?

**RSA (Rivest-Shamir-Adleman)** - –∞—Å–∏–º–µ—Ç—Ä–∏—á–Ω–∞ –∫—Ä–∏–ø—Ç–æ—Å–∏—Å—Ç–µ–º–∞, –∑–∞—Å–Ω–æ–≤–∞–Ω–∞ –Ω–∞ –º–∞—Ç–µ–º–∞—Ç–∏—á–Ω—ñ–π —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ —Ä–æ–∑–∫–ª–∞–¥—É –≤–µ–ª–∏–∫–∏—Ö —á–∏—Å–µ–ª –Ω–∞ –ø—Ä–æ—Å—Ç—ñ –º–Ω–æ–∂–Ω–∏–∫–∏.

### –ö–ª—é—á–æ–≤—ñ –æ—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ

| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ó–Ω–∞—á–µ–Ω–Ω—è |
|----------|----------|
| **–ê–ª–≥–æ—Ä–∏—Ç–º** | RSA (–∞—Å–∏–º–µ—Ç—Ä–∏—á–Ω–µ) |
| **–†–æ–∑–º—ñ—Ä –∫–ª—é—á–∞** | 2048 –±—ñ—Ç–∏ (~617 —Ü–∏—Ñ—Ä) |
| **Padding** | OAEP –∑ SHA-256 |
| **Hash —Ñ—É–Ω–∫—Ü—ñ—è** | SHA-256 |
| **MGF** | MGF1 –∑ SHA-256 |
| **Max —Ä–æ–∑–º—ñ—Ä –¥–∞–Ω–∏—Ö** | 190 –±–∞–π—Ç |
| **–ö–æ–¥—É–≤–∞–Ω–Ω—è** | Base64 –¥–ª—è –ë–î |
| **–î–µ—Ç–µ—Ä–º—ñ–Ω–æ–≤–∞–Ω—ñ—Å—Ç—å** | –ù—ñ (OAEP –Ω–µ-–¥–µ—Ç–µ—Ä–º—ñ–Ω—ñ—Å—Ç–∏—á–Ω–∏–π) |

### –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞

#### –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–ª—é—á—ñ–≤
1. –í–∏–±–∏—Ä–∞—é—Ç—å—Å—è –¥–≤–∞ –≤–µ–ª–∏–∫—ñ –≤–∏–ø–∞–¥–∫–æ–≤—ñ –ø—Ä–æ—Å—Ç—ñ —á–∏—Å–ª–∞ `p` —Ç–∞ `q`
2. –û–±—á–∏—Å–ª—é—î—Ç—å—Å—è –º–æ–¥—É–ª—å: `n = p √ó q`
3. –û–±—á–∏—Å–ª—é—î—Ç—å—Å—è —Ñ—É–Ω–∫—Ü—ñ—è –ï–π–ª–µ—Ä–∞: `œÜ(n) = (p-1)(q-1)`
4. –í–∏–±–∏—Ä–∞—î—Ç—å—Å—è –ø—É–±–ª—ñ—á–Ω–∏–π –ø–æ–∫–∞–∑–Ω–∏–∫: `e = 65537` (–Ω–∞–π—á–∞—Å—Ç—ñ—à–µ)
5. –û–±—á–∏—Å–ª—é—î—Ç—å—Å—è –ø—Ä–∏–≤–∞—Ç–Ω–∏–π –ø–æ–∫–∞–∑–Ω–∏–∫: `d` —Ç–∞–∫–∏–π, —â–æ `e √ó d ‚â° 1 (mod œÜ(n))`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- **–ü—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á** (e, n) - –¥–ª—è —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è
- **–ü—Ä–∏–≤–∞—Ç–Ω–∏–π –∫–ª—é—á** (d, n) - –¥–ª—è —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è

#### –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è
```
C ‚â° M^e (mod n)
–¥–µ M - –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, C - —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç
```

#### –†–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è
```
M ‚â° C^d (mod n)
–¥–µ C - —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç, M - —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω–µ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è
```

### Padding: OAEP

**OAEP (Optimal Asymmetric Encryption Padding)** - –º–µ—Ç–æ–¥ –¥–æ–ø–æ–≤–Ω–µ–Ω–Ω—è –¥–ª—è –±–µ–∑–ø–µ—á–Ω–æ–≥–æ RSA:

- –î–æ–¥–∞—î –≤–∏–ø–∞–¥–∫–æ–≤—ñ—Å—Ç—å –¥–æ –∫–æ–∂–Ω–æ–≥–æ —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è
- –ü–æ–ø–µ—Ä–µ–¥–∂–∞—î –∞—Ç–∞–∫–∏ –Ω–∞ —Å–µ–º–∞–Ω—Ç–∏–∫—É
- –ó–∞—Ö–∏—â–∞—î –≤—ñ–¥ Bleichenbacher –∞—Ç–∞–∫
- –†–æ–±–∏—Ç—å –∫—Ä–∏–ø—Ç–æ—Ç–µ–∫—Å—Ç –Ω–µ –¥–µ—Ç–µ—Ä–º—ñ–Ω–æ–≤–∞–Ω–∏–º (–æ–¥–∏–Ω —Ç–µ–∫—Å—Ç ‚Üí —Ä—ñ–∑–Ω—ñ —à–∏—Ñ—Ä–æ—Ç–µ–∫—Å—Ç–∏)

### –†–µ–∞–ª—ñ–∑–∞—Ü—ñ—è —É –ø—Ä–æ–µ–∫—Ç—ñ

```python
from cryptography.hazmat.primitives.asymmetric import rsa, padding
from cryptography.hazmat.primitives import serialization, hashes
import base64

# –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –∫–ª—é—á—ñ–≤
private_key = rsa.generate_private_key(
    public_exponent=65537,
    key_size=2048,
)
public_key = private_key.public_key()

# –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è
def encrypt_text(plaintext: str) -> bytes:
    plaintext_bytes = plaintext.encode('utf-8')
    encrypted = public_key.encrypt(
        plaintext_bytes,
        padding.OAEP(
            mgf=padding.MGF1(algorithm=hashes.SHA256()),
            algorithm=hashes.SHA256(),
            label=None
        )
    )
    return base64.b64encode(encrypted)

# –†–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è
def decrypt_text(encrypted_token: bytes) -> str:
    encrypted_bytes = base64.b64decode(encrypted_token)
    decrypted = private_key.decrypt(
        encrypted_bytes,
        padding.OAEP(
            mgf=padding.MGF1(algorithm=hashes.SHA256()),
            algorithm=hashes.SHA256(),
            label=None
        )
    )
    return decrypted.decode('utf-8')
```

---

## –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è

### 1. –ì–µ–Ω–µ—Ä–∞—Ü—ñ—è –ø–∞—Ä–æ–ª—è –≤—Ä—É—á–Ω—É

```python
from users.crypto import encrypt_text, decrypt_text
import secrets
import string

# –°—Ç–≤–æ—Ä–∏—Ç–∏ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ—ñ—á–Ω–æ –±–µ–∑–ø–µ—á–Ω–∏–π –ø–∞—Ä–æ–ª—å
chars = string.ascii_letters + string.digits + string.punctuation
password = ''.join(secrets.choice(chars) for _ in range(32))
print(f"–ü–∞—Ä–æ–ª—å: {password}")
```

### 2. –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è –ø–∞—Ä–æ–ª—è

```python
from users.crypto import encrypt_text, decrypt_text

plaintext = "MySecurePassword123!"

# –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è
encrypted = encrypt_text(plaintext)
print(f"–ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π: {encrypted}")

# –†–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è
decrypted = decrypt_text(encrypted)
print(f"–†–æ–∑—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π: {decrypted}")
assert plaintext == decrypted
```

### 3. –ó–±–µ—Ä–µ–∂–µ–Ω–Ω—è –≤ –ë–î

```python
from users.models import PasswordEntry
from django.contrib.auth.models import User

user = User.objects.get(username='john')

# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∑–∞–ø–∏—Å—É
entry = PasswordEntry.objects.create(
    owner=user,
    title='GitHub',
    login='john@example.com',
    url='https://github.com',
    notes='–ú—ñ–π —Ä–∞—Ö—É–Ω–æ–∫ GitHub'
)

# –®–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —Ç–∞ –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—è
entry.set_password('MyGitHubPassword123!')
entry.save()

# –ü—ñ–∑–Ω—ñ—à–µ: –æ—Ç—Ä–∏–º–∞–Ω–Ω—è —Ç–∞ —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è
retrieved = PasswordEntry.objects.get(id=entry.id)
password = retrieved.get_password()  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ä–æ–∑—à–∏—Ñ—Ä—É—î—Ç—å—Å—è
print(f"–ü–∞—Ä–æ–ª—å: {password}")
```

### 4. REST API

```bash
# –û—Ç—Ä–∏–º–∞—Ç–∏ –∑–≥–µ–Ω–µ—Ä–æ–≤–∞–Ω–∏–π –ø–∞—Ä–æ–ª—å
curl "http://localhost:8000/users/generate-password/?length=24"

# –û–±—Ä–æ–±–∏—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å
python -m json.tool <<< '{"password": "aB3$cD9#eF7@gH2%iJ5&kL8*"}'
```

---

## –ë–µ–∑–ø–µ–∫–∞

### ‚úÖ –ü—Ä–µ–≤–∞–≥–∏ RSA-2048

- **–ê—Å–∏–º–µ—Ç—Ä–∏—á–Ω–µ** - –ø—É–±–ª—ñ—á–Ω–∏–π –∫–ª—é—á –º–æ–∂–Ω–∞ –¥—ñ–ª–∏—Ç–∏, –ø—Ä–∏–≤–∞—Ç–Ω–∏–π –∑–∞–ª–∏—à–∞—î—Ç—å—Å—è —Å–µ–∫—Ä–µ—Ç–Ω–∏–º
- **–ù–∞–¥—ñ–π–Ω–µ** - —Å—Ç—ñ–π–∫—ñ—Å—Ç—å –∑–∞–ª–µ–∂–∏—Ç—å –≤—ñ–¥ —Å–∫–ª–∞–¥–Ω–æ—Å—Ç—ñ —Ä–æ–∑–∫–ª–∞–¥—É –Ω–∞ –º–Ω–æ–∂–Ω–∏–∫–∏
- **OAEP Padding** - –∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ –∞—Ç–∞–∫ –Ω–∞ —Å–µ–º–∞–Ω—Ç–∏–∫—É
- **Non-deterministic** - OAEP —Ä–æ–±–∏—Ç—å —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è —ñ–º–æ–≤—ñ—Ä–Ω—ñ—Å–Ω–∏–º
- **–ü—Ä–æ–º–∏—Å–ª–æ–≤—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–∏** - –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è —É HTTPS, —Ü–∏—Ñ—Ä–æ–≤–∏—Ö –ø—ñ–¥–ø–∏—Å–∞—Ö

### ‚ö†Ô∏è –û–±–º–µ–∂–µ–Ω–Ω—è

- **–†–æ–∑–º—ñ—Ä –¥–∞–Ω–∏—Ö** - max 190 –±–∞–π—Ç –¥–ª—è RSA-2048 + OAEP
- **–®–≤–∏–¥–∫—ñ—Å—Ç—å** - –ø–æ–≤—ñ–ª—å–Ω—ñ—à–µ –∑–∞ —Å–∏–º–µ—Ç—Ä–∏—á–Ω—ñ –∞–ª–≥–æ—Ä–∏—Ç–º–∏
- **–†–æ–∑–º—ñ—Ä –∫–ª—é—á–∞** - 2048 –±—ñ—Ç–∏ = –≤–µ–ª–∏–∫–∞ –¥–æ–≤–∂–∏–Ω–∞ –∫–ª—é—á–∞

### üîí –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü—ñ—ó –¥–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏

```python
# .gitignore - –Ω–µ –∫–æ–º–º—ñ—Ç—å—Ç–µ —Ü–µ:
db.sqlite3
.env
.venv/
__pycache__/
*.pyc
```

### üõ°Ô∏è –î–ª—è production

1. **–ó–±–µ—Ä—ñ–≥–∞–π—Ç–µ –∫–ª—é—á—ñ —É –∑–º—ñ–Ω–Ω–∏—Ö –æ—Ç–æ—á–µ–Ω–Ω—è:**
   ```python
   import os
   RSA_PRIVATE_KEY = os.environ.get('RSA_PRIVATE_KEY')
   RSA_PUBLIC_KEY = os.environ.get('RSA_PUBLIC_KEY')
   ```

2. **–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ HTTPS** –¥–ª—è –≤—Å—ñ—Ö –∑'—î–¥–Ω–∞–Ω—å

3. **–†–µ–≥—É–ª—è—Ä–Ω–æ —Ä–æ—Ç—É–π—Ç–µ –∫–ª—é—á—ñ** (–∫–æ–∂–Ω—ñ 90 –¥–Ω—ñ–≤)

4. **–ü—Ä–∞–≤–∏–ª—å–Ω—ñ –¥–æ–∑–≤–æ–ª–∏ —Ñ–∞–π–ª—ñ–≤:**
   ```bash
   chmod 600 /path/to/private_key
   chmod 644 /path/to/public_key
   ```

5. **–†–µ–∑–µ—Ä–≤–Ω—ñ –∫–æ–ø—ñ—ó –∫–ª—é—á—ñ–≤** —É –±–µ–∑–ø–µ—á–Ω–æ–º—É –º—ñ—Å—Ü—ñ

---

## –§–∞–π–ª–∏ –ø—Ä–æ–µ–∫—Ç—É

### –ö–ª—é—á–æ–≤—ñ —Ñ–∞–π–ª–∏

| –§–∞–π–ª | –û–ø–∏—Å |
|------|------|
| `users/crypto.py` | üîê –û—Å–Ω–æ–≤–Ω–∞ –ª–æ–≥—ñ–∫–∞ RSA-2048 —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è |
| `users/models.py` | üì¶ –ú–æ–¥–µ–ª—ñ PasswordEntry —Ç–∞ VaultEntry |
| `users/views.py` | üåê REST API endpoint –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü—ñ—ó –ø–∞—Ä–æ–ª—ñ–≤ |
| `users/forms.py` | üìù Django —Ñ–æ—Ä–º–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø–∞—Ä–æ–ª—è–º–∏ |
| `requirements.txt` | üìã –ó–∞–ª–µ–∂–Ω–æ—Å—Ç—ñ Python |
| `manage.py` | ‚öôÔ∏è DjangoÂëΩ‰ª§-line —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å |

### –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è

| –§–∞–π–ª | –û–ø–∏—Å |
|------|------|
| `travelbook/settings.py` | –ö–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è Django |
| `travelbook/urls.py` | –ì–æ–ª–æ–≤–Ω—ñ URL –º–∞—Ä—à—Ä—É—Ç–∏ |
| `travelbook/wsgi.py` | WSGI –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ—è |

### –ë–∞–∑–∞ –¥–∞–Ω–∏—Ö

| –§–∞–π–ª | –û–ø–∏—Å |
|------|------|
| `db.sqlite3` | SQLite –±–∞–∑–∞ –¥–∞–Ω–∏—Ö (—Ä–æ–∑—Ä–æ–±–∫–∞) |
| `users/migrations/` | –ú—ñ–≥—Ä–∞—Ü—ñ—ó –ë–î |

---

## –°–∏—Å—Ç–µ–º–∞ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤

### –ú–µ–≥–∞-—é–∑–µ—Ä (Mega Admin)

–ü—Ä–æ–µ–∫—Ç –º–∞—î —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—É —Å–∏—Å—Ç–µ–º—É "–º–µ–≥–∞-–∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞", —è–∫–∏–π –º–æ–∂–µ –≤–∏–¥–∞–≤–∞—Ç–∏ –ø—Ä–∞–≤–∞ —Å—É–ø–µ—Ä—é–∑–µ—Ä–∞ —ñ–Ω—à–∏–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞–º.

**–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è:**
```python
# travelbook/settings.py
MEGA_ADMIN_USERNAME = 'ptrkxlord'  # –ú–µ–≥–∞-–∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º
```

**–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª –º–µ–≥–∞-–∞–¥–º—ñ–Ω–∞:**
- –ü–µ—Ä–µ–≥–ª—è–¥–∞—Ç–∏ —Å–ø–∏—Å–æ–∫ –≤—Å—ñ—Ö –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤: `/users/admins/`
- –í–∏–¥–∞–≤–∞—Ç–∏ –ø—Ä–∞–≤–∞ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞: –Ω–∞—Ç–∏—Å–Ω—É—Ç–∏ "Make Admin" –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä—ñ–≤
- –†–æ–±–∏—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏ (–º–∞—î –ø—Ä–∞–ø–æ—Ä `is_staff`)

**–Ø–∫ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—Ç–∏—Å—è:**

1. –ó–∞—Ä–µ—î—Å—Ç—Ä—É–π—Ç–µ—Å—è –∑ —ñ–º'—è–º –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ `ptrkxlord` (–∞–±–æ –∑–º—ñ–Ω—ñ—Ç—å —É `settings.py`)
2. –ü–µ—Ä–µ–π–¥—ñ—Ç—å –Ω–∞ `/users/admins/`
3. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å "Make Admin" –±—ñ–ª—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
4. –ö–æ—Ä–∏—Å—Ç—É–≤–∞—á –æ—Ç—Ä–∏–º–∞—î –ø—Ä–∞–≤–∞ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞

**–Ü–Ω—à—ñ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∏:**
- –ú–æ–∂—É—Ç—å –∫–µ—Ä—É–≤–∞—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–æ–º (–±–ª–æ–≥–∏, —Ç—É—Ä–∏ —Ç–æ—â–æ)
- –ù–µ –º–æ–∂—É—Ç—å –≤–∏–¥–∞–≤–∞—Ç–∏ –ø—Ä–∞–≤–∞ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —ñ–Ω—à–∏–º (—Ç—ñ–ª—å–∫–∏ –º–µ–≥–∞-–∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä)
- –ü–æ–º—ñ—Ç–Ω—ñ –∑–Ω–∞—á–∫–æ–º –≤ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ñ–π –ø–∞–Ω–µ–ª—ñ

---

## –ö–æ–º–∞–Ω–¥–∏ –¥–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏

```bash
# –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π
pip install -r requirements.txt

# –ú—ñ–≥—Ä–∞—Ü—ñ—ó
python manage.py makemigrations
python manage.py migrate

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞
python manage.py runserver

# Django shell (–∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞ –∫–æ–Ω—Å–æ–ª—å)
python manage.py shell
>>> from users.crypto import encrypt_text, decrypt_text
>>> encrypt_text("test_password")

# –û—á–∏—â–µ–Ω–Ω—è –ë–î (—Ä–æ–∑—Ä–æ–±–∫–∞)
rm db.sqlite3
python manage.py migrate

# –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞
python manage.py createsuperuser

# –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–¥—É
python -m py_compile users/*.py
```

---

## –ü—Ä–æ–±–ª–µ–º–∏ —Ç–∞ —Ä—ñ—à–µ–Ω–Ω—è

| –ü—Ä–æ–±–ª–µ–º–∞ | –†—ñ—à–µ–Ω–Ω—è |
|----------|---------|
| `ModuleNotFoundError: cryptography` | `pip install cryptography>=46.0.3` |
| `no such table: tours_tour` | `python manage.py migrate` |
| Port 8000 –∑–∞–π–Ω—è—Ç–∏–π | `python manage.py runserver 8001` |
| `duplicate column` –≤ –º—ñ–≥—Ä–∞—Ü—ñ—è—Ö | `rm db.sqlite3` —ñ –ø–æ–≤—Ç–æ—Ä–∏—Ç–∏ migrate |
| Permission denied (—Ñ–∞–π–ª–∏) | `chmod 755 /path/to/project` |

---



